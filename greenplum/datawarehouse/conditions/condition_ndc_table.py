
import pyodbc
import itertools

con = pyodbc.connect('DSN=PostgreSQL35W')

#copy and pasted from Condition Logic v40
opi_ndc = '''00591264101
52544008201
00143300001
00247084530
00591322001
00603255321
21695025828
51991007301
52544095801
52959091260
55887076940
55887076960
42195084010
66992084010
68047072001
00121050404
00121050405
00121050410
00121050412
00121050415
00121050416
00121100800
00121100812
00603102058
00603901354
00603901358
21695054704
23490796901
46672056116
50383007905
50383007906
50383007912
50383007913
50383007916
52959014103
52959014104
54569100100
54868037801
54868037802
60432024504
60432024516
66267099704
00187000301
00093005001
00406048301
00603233721
13107005801
43063076315
54569031100
54569031102
55289044915
55289044930
63874025901
63874025903
63874025904
63874025912
63874025915
63874025920
63874025924
63874025930
63874025960
00093015001
00093015010
00247007845
00406048401
00406048403
00406048410
00406048420
00406048423
00406048450
00406048462
00603233802
00603233804
00603233816
00603233820
00603233821
00603233822
00603233828
00603233832
13107005901
13107005999
16590002315
21695024212
23490500400
23490500401
23490500402
23490500403
23490500404
23490500405
23490500406
23490500407
23490500408
23490500409
33358000101
43063001403
43063001404
43063001406
43063001412
43063055406
43063055410
43063055412
43063055415
43063055418
43063055420
43063055424
43063055425
43063055428
43063055430
43063055460
43063055490
43063055498
50458051360
50458051380
51079016101
51079016120
51079016121
51079016196
51079016199
52959000300
52959000302
52959000304
52959000306
52959000310
52959000312
52959000315
52959000316
52959000320
52959000324
52959000325
52959000328
52959000330
52959000340
52959000342
52959000345
52959000350
52959000360
52959000375
52959000384
52959000390
54569002402
54569002500
54569002501
54569002502
54569002503
54569002504
54569002506
54569002507
54569002509
54569252301
54569252304
54569252306
54569252307
55289000506
55289000510
55289000512
55289000515
55289000518
55289000520
55289000524
55289000525
55289000530
55289000560
55289000590
55289000598
55289004815
55887095150
58864000415
60429050060
60429050090
60760002215
60760002230
63304056201
63304056210
63739000410
63874020202
63874020205
64720030410
64720030411
64720030450
65162003311
66267075906
66336005930
68084037201
68084037211
00093035001
00093035005
00093035010
00406048501
00406048505
00603233921
00603233928
13107006001
13107006005
13107006099
21695024328
23490500500
23490500501
23490500502
23490500503
33358000260
49999002601
49999002630
49999002640
49999002660
49999002690
50458051560
50458051570
52959044602
52959044620
52959044650
52959044690
54569030201
54569030202
54569030208
55289091620
55289091630
55289091690
63304056101
63304056105
63874026701
63874026702
63874026703
63874026704
63874026705
63874026708
63874026710
63874026712
63874026715
63874026720
63874026728
63874026730
63874026740
63874026750
63874026760
63874026790
64720030510
68084037301
68084037311
00121477205
00121477240
00121465505
00121154410
00121154440
00121477210
00074305413
00074305453
00406037801
00406037805
00591217601
00591217605
27808011601
27808011602
43386035301
43386035305
59630091110
64376064301
64376064305
65162069610
65162069650
68453091110
00095067416
00095909016
17478045016
59702067416
00074304113
00074304153
00406037601
00406037605
00591217401
00591217405
27808011401
27808011402
43386035101
43386035105
59630091210
64376064801
64376064805
68084085225
68084085295
00074304313
00074304353
00406037701
00406037705
00591217501
00591217505
27808011501
27808011502
43386035201
43386035205
59630091310
64376064901
64376064905
68084099011
68084099021
68453091310
00406012501
00406012505
00406012510
00406012512
00406012523
00406012562
00406036701
00406036705
00406036723
00406036762
00591085301
00591085305
00591261201
00591261205
00603360921
00603388702
00603388704
00603388712
00603388720
00603388721
00603388722
00603388726
00603388728
00603388732
00904642161
13107002101
13107002105
13107002199
16590011830
21695027200
23490705300
23490705301
23490705302
23490705303
23490705304
23490705305
27808003701
27808003702
27808003703
33358017001
42291033401
42858020301
42858020350
43063033901
43063033920
43063033930
43063033960
43063033990
43063033998
43063074906
43063074915
43063074920
43063074921
43063074930
43063074940
43063074956
43063074960
43063074984
43063074988
43063074990
43063074993
43063074998
43353015930
43353015960
49999001920
49999001930
49999016900
49999016901
49999016918
49999016920
49999016930
49999016950
49999016960
49999016990
50268040215
50268040815
50474093201
51079077901
51079077920
51079077921
51862021701
51862021705
51862022901
51862022905
51862058701
51862058705
52544016101
52544016105
52544053901
52544053905
52959032400
52959032401
52959032402
52959032403
52959032405
52959032406
52959032408
52959032410
52959032415
52959032420
52959032424
52959032425
52959032428
52959032430
52959032440
52959032442
52959032445
52959032450
52959032460
52959032475
52959032484
52959032490
52959053324
52959053330
52959053340
53746011001
53746011005
53746011010
54569524000
54569524001
54569524002
54569524004
54569524005
54569524006
54569524008
55289065130
55289073706
55289073715
55289073720
55289073721
55289073730
55289073740
55289073756
55289073760
55289073784
55289073788
55289073790
55289073793
55289073798
57664017613
57664017688
60429057412
60429057418
60429057460
60429057490
60760038815
60760038830
60760038860
60760038890
68084010001
68084035301
68084035311
68084088401
68084088409
68084088411
68308022301
68308022601
68387023512
00121477107
00121477115
00486077116
63717089516
00591217101
13811065710
68025006910
00406012301
00406012305
00406012310
00406012312
00406012323
00406012362
00406036501
00406036505
00406036523
00406036562
00591217201
00591217205
00591320201
00591320205
00603389002
00603389004
00603389016
00603389020
00603389021
00603389022
00603389028
00603389032
00904641961
00904656761
13107001901
13107001905
21695026828
23490748700
23490748701
23490748702
23490748703
23490748709
27808003501
27808003502
27808003503
42291033201
42858020101
42858020150
43063009102
43063009104
43063009106
43063009120
43063068610
43063068612
43063068615
43063068620
43063068630
43063068640
43063068656
43063068660
43063068684
43063068688
43063068690
43063068693
43063068698
43386035601
49999060801
49999060830
49999060860
49999060890
50268040115
50268040315
50474093001
51079077701
51079077720
51079077721
51862021501
51862021505
51862022701
51862022705
51862058501
51862058505
52544007101
52544091301
52959073702
52959073715
52959073720
52959073725
52959073728
52959073730
52959073740
52959073742
52959073745
52959073750
52959073760
52959073790
53746010901
53746010905
53746010910
54569552300
54569552302
54569552303
54569552304
55289089415
55289099702
55289099704
55289099706
55289099712
55289099715
55289099730
55289099756
55289099784
55289099788
55289099790
55887029501
57664012613
57664012688
60429057201
60429057205
60429057212
60429057218
60429057230
60429057260
60429057290
63739032610
63739053210
63739070410
68084036801
68084036811
68084089501
68084089509
68084089511
68308022101
68308022401
00406012401
00406012405
00406012410
00406012412
00406012423
00406012462
00406036601
00406036605
00406036623
00406036662
00591260501
00591260505
00591320301
00603389102
00603389121
00603389122
00603389128
00603389132
00904642061
13107002001
13107002005
21695038610
23490748603
23490748604
23490748607
23490748609
27808003601
27808003602
27808003603
42291033301
42858020201
42858020250
43063026506
43063068506
43063068512
43063068515
43063068520
43063068530
43063068560
43386035701
43547037310
49999060901
49999060930
49999060960
49999060990
50268040015
50474093101
51079077801
51079077820
51079077821
51862021601
51862021605
51862022801
51862022805
51862058601
51862058605
52544016201
52544072901
52959073500
52959073502
52959073503
52959073530
52959073540
52959073550
52959073560
52959073580
52959073584
52959073590
54569530500
54569602701
54569602702
54569602703
55289080212
55289080220
55289080230
55289080260
55289080290
57664017013
57664017088
60429057301
60429057305
60429057312
60429057318
60429057330
60429057360
60429057390
65162011510
65162011511
65162011550
68084060101
68084060111
68084086301
68084086309
68084086311
68308022201
68308022501
68387023712
00121077204
00121077216
00121231615
00121231640
00121477215
00713070389
00713070489
13551080105
64376064016
64376064040
64950034047
66689002301
66689002304
66689002316
66689002350
68094071459
68094071462
76014000125
76181000125
24090068371
24090068379
24090068385
24090068388
59702068301
24090068171
24090068179
24090068185
24090068188
59702068101
24090068285
24090068288
59702068201
00228298311
00378710601
00406052301
00406052305
00406052362
00591093201
00603498221
00603498228
00904643961
13107004601
13107004605
16590061830
21695061940
23490759201
23490759202
23490759203
23490759204
23490759207
23490759209
31722019401
31722019405
42291064601
42858010401
42858010450
43063023120
43063023130
43063023160
43063023190
43063052806
43063052830
43063052860
43063052890
43063052898
47781023001
47781023005
47781023063
49999085405
53746020401
53746020405
54868502400
54868502405
55887012901
57664016088
60951071270
63481062970
63739021710
63874123300
63874123303
63874123306
63874123309
66336014794
68071034430
68084037801
68084037811
68084071001
68308048047
68308084301
00378710301
00603497821
31722019101
60951070170
63481062770
68308084001
00054055125
00054055129
00054465025
00054865024
00228298111
00228298150
00378710401
00406051201
00406051205
00406051223
00406051262
00406051291
00591074901
00591074905
00603499821
00603499828
00904643761
13107004401
13107004405
16590061962
23490605300
23490605301
23490605302
23490605303
23490605304
23490605305
23490605306
23490605307
23490605308
23490605309
31722019201
31722019205
42291064501
42858010201
42858010250
43063002502
43063002504
43063002506
43063002512
43063027904
43063027906
43063027910
43063027912
43063027918
43063027920
43063027924
43063027930
43063027940
43063027960
43063027986
43063027990
43063027993
43063027998
43063027999
43063065302
43063065304
43063065306
43063065310
43063065312
43063065318
43063065320
43063065324
43063065330
43063065340
43063065356
43063065360
43063065388
43063065390
43063065398
47781019601
47781019605
49999085201
49999085230
49999085260
49999085290
52959055602
52959055630
52959055660
52959055690
53746020301
53746020305
54868170001
54868170002
54868170004
54868170007
55289095110
55289095112
55289095115
55289095120
55289095124
55289095130
55289095140
55289095156
55289095160
55289095173
55289095186
55289095190
55289095193
55289095198
55289095199
57664015513
57664015588
60951060270
60951060285
63481062370
63481062385
63739070910
63874122700
63874122701
63874122703
63874122706
63874122709
68071015830
68071015840
68071015860
68071015890
68071015891
68071022420
68071022430
68084035501
68084035511
68094001361
68308040547
68308084101
00054368663
00054864816
00228298211
00378710501
00406052201
00406052205
00406052262
00591093301
00603497921
00603497928
00904643861
13107004501
13107004505
23490782603
23490782606
23490782607
23490782609
23490782703
23490782706
23490782709
31722019301
31722019305
42858010301
42858010350
43063037912
43063037930
43063052312
43063052330
47781022901
47781022905
47781022963
49999085301
49999085330
49999085360
49999085390
52959055402
52959055430
52959055460
52959055490
54868533804
57664015688
60951070070
63481062870
63739063610
65162020710
65162020750
68084037901
68084037911
68084069901
68084069911
68308047547
68308084201
23635011501
00591039601
21695063460
43386067001
00172635900
00172635910
00172635960
00172635970
00378808801
00378808805
16590063471
21695014372
21695023620
23490758601
23490758602
23490758603
23490758604
23490758605
23490758606
33358034330
42291083290
42571011901
42571011905
43063059901
43063059915
43063059920
43063059930
43063059960
43063078220
43063078230
43063078260
49884094601
49884094605
49999011830
49999069300
49999069330
49999069360
50268077315
50268077415
50458065010
50458065060
52959066600
52959066602
52959066620
52959066628
52959066630
52959066640
52959066656
52959066660
52959066690
52959081400
52959081410
52959081412
52959081415
52959081418
52959081420
52959081430
52959081440
52959081460
52959081490
53746061701
53746061705
53746061710
54569530800
54569530801
54569568000
54569568001
54569568002
54569568003
54868529100
55289061720
55289089515
55289089520
55289089530
55289089560
57664053713
57664053718
57664053788
60429050001
60429050005
60505264401
60505264405
60760005320
65162061710
65162061711
65162061750
65862092201
65862092205
67877032201
67877032205
68084013901
68084013911
68084049601
68084049611
68084082501
68084082511
68382033401
68382033405
00527131201
00591354601
00591354605
23490682503
51991007401
51991007405
52544095601
52959086500
52959086530
54868103701
54868103703
55289002620
63629295201
63874021901
63874021920
63874021925
63874021930
68308031210
00247121620
00247201512
49708041988
55289033915
57664041988
00185074901
00247176120
52959086800
52959086860
52959086890
64980017601
00378611701
00591355101
60951031070
68308084501
00574704512
00574704012
00093360140
42858049340
54569632500
59011075104
00093360240
42858058640
59011075804
63481020760
00093360340
42858083940
54569632600
59011075204
59385002360
63481034860
59385002460
63481051960
00093360040
42858075040
59011075004
59385002560
63481068560
42858035340
59011075704
59385002160
63481016101
63481016160
63481082060
59385002760
63481095260
59385001201
59385001230
59385001401
59385001430
59385001601
59385001630
00054309036
00378963943
54569598800
60505081301
00054024324
00054024424
00054024425
00527169801
00527169891
51224030010
68094076059
68094076062
68094076159
68094076162
00054024525
00527169901
54868254100
54868254101
54868254102
63459054104
63459054128
20482000110
20482000130
42358010032
42747022132
57881033132
00093690319
00093690345
00245042305
00245042389
00378912416
00378912498
00406900076
00591321454
00591321472
00591360372
00781724455
47781042847
49884076478
49999083401
49999083405
50458009405
54868152300
60505700400
60505700402
60505700900
60505700902
60505701400
60505701402
67767012318
13913000901
51772031101
51772031104
00378911916
00378911998
00406901276
00781724055
35356006205
47781042347
50458009005
60505701000
60505701002
00093786965
00406921230
49884046355
55253007401
55253007430
63459051201
63459051230
00093787065
00406921630
49884046455
55253007501
55253007530
63459051601
63459051630
63459054204
63459054228
00093786565
00406920230
49884045952
49884045955
55253007001
55253007030
63459050201
63459050230
20482000210
20482000230
42358020032
42747022232
57881033232
00093690019
00093690045
00245042005
00245042089
00378912116
00378912198
00406902576
00591319854
00591319872
00591360072
00781724155
47781042447
49884076152
49884076178
49999083101
49999083105
50458009105
51862031452
51862031478
54868016200
54868307400
60505700100
60505700102
60505700600
60505700602
60505701100
60505701102
67767012018
42358030032
42747022332
57881033332
13913001301
00378912598
65293001106
63459054404
63459054428
00093786665
00406920430
49884046055
52959054930
55253007101
55253007130
63459050401
63459050430
20482000410
20482000430
42358040032
42747022432
57881033432
13913001001
51772031401
51772031404
00093690119
00093690145
00245042105
00245042189
00378912216
00378912298
00406905076
00591321254
00591321272
00591360172
00781711255
00781724255
47781042647
49884076252
49884076278
49999083201
49999083205
50458009205
54868024400
60505700200
60505700202
60505700700
60505700702
60505701200
60505701202
67767012118
63459054604
63459054628
00093786765
00406920630
49884046155
52959054830
55253007201
55253007230
63459050601
63459050630
20482000630
20482001215
42358060032
42747022632
57881033632
00378912698
00093690219
00093690245
00245042205
00245042289
00378912316
00378912398
00406907576
00591321354
00591321372
00591360272
00781724355
47781042747
49884076352
49884076378
49999083301
49999083305
50458009305
54868028700
60505700300
60505700302
60505700800
60505700802
60505701300
60505701302
67767012218
63459054804
63459054828
00093786865
00406920830
49884046255
52959055330
55253007301
55253007330
63459050801
63459050830
20482000830
20482001615
42358080032
42747022832
57881033832
00378912798
43376021010
43376031060
65224031060
59011027660
59011027760
43376021510
43376031560
65224031560
43376022010
43376032060
65224032060
59011027160
43376023010
43376033060
65224033060
59011027260
43376024010
43376034060
65224034060
59011027360
43376025010
43376035060
65224035060
59011027460
59011027560
00603358621
23710090201
50991057901
51021091030
53746011701
60846090201
63717090201
23710090001
53746011601
60846090001
63717090001
00603358421
23710090101
50991057801
53746014601
60846090101
63717090101
00074227712
00074227714
00074227754
00093516101
00247172700
00247172704
00247172706
00247172720
00247172724
00247172750
00247204106
00247204112
00247204120
00603389721
00603389728
13107000401
21695063120
23490708600
23490708602
23490708603
43063034920
43063034930
43063034960
49999058801
49999058815
49999058830
49999058860
49999058890
52959052212
52959052215
52959052220
52959052230
52959052240
52959073800
52959073802
52959073812
52959073815
52959073820
52959073830
52959073840
52959073850
52959073860
52959073890
53746014501
54569612100
54868403500
54868497600
55289034815
55289094415
55289094430
55289094460
62037052401
62037052405
63739055710
63874110601
63874110602
63874110603
63874110604
63874110605
63874110606
63874110608
63874110609
65162014510
68084022701
68084022711
68084084101
68084084109
00054038663
42858030416
42858041616
59011045101
00406331201
00574029401
00591373901
23635041201
00406331601
00574029501
00591363001
23635041601
00406324301
00527135301
13107010701
23490777801
23490777803
23490777806
23490777809
42858012201
42858030101
42858030125
43063005106
52959042002
59011045201
59011045210
63739027510
68084042301
68084042311
00574722406
00406333201
00574029701
00591363101
13811070410
23635043201
00054026424
00054026425
00406324401
00527135401
13107010801
23490777903
23490777906
23490777908
23490777909
42858023401
42858023450
42858030201
42858030225
42858030250
49999083501
49999083530
49999083560
49999083590
55154161001
59011045401
59011045405
59011045410
63739079110
68084047201
68084047211
00054026525
00406324901
00527135501
13107010901
42858030301
42858033801
49999083601
49999083690
51224010250
52959041302
52959041360
54868459800
59011045810
68084079821
68094085261
00406330801
00574029301
00591362901
23635040801
00228402911
00555077802
00054043825
42358010210
00024033704
00024033705
00054459625
00555038202
00555039202
00603441621
30698033701
42806005101
49999083801
49999083830
57664047108
60429053501
00024033504
00024033505
00054459525
00054859511
00555038102
00603441521
23490930003
23490930006
23490930009
42806005001
49999083730
54868123301
54868123302
54868123303
55887005130
57664046708
60429053401
68071076030
00054354563
51293062201
00054421925
00054457125
00054855424
00406577101
00406577162
00904653060
00904653061
13107008901
23490587703
23490587706
23490587707
23490587709
54868494800
54868494801
54868494802
54868494803
54868494804
54868494805
54868494806
55289081430
55289081460
55289081490
55289081493
55289081498
55289081499
55887020001
55887020005
55887020010
55887020020
55887020030
55887020050
63739000610
63874126503
63874126506
66689081010
67877011601
68084073801
00054355663
66689071216
00054039168
00054039268
00054355344
00406052710
00406872510
66689069430
66689069479
66689069579
00406054034
00406254001
49999084130
49999084160
60687020932
60687020933
66689089840
68084097732
68084097733
00054421825
00054457025
00054855324
00406575501
00406575562
00406697434
13107008801
23490587801
23490587802
23490587803
23490587809
43063022260
43063022290
43063022293
43063022298
49999096330
49999096360
49999096390
52959043502
52959043560
52959043590
54868570100
55887009030
55887009060
60687021401
00054355563
66689071116
70004013282
00574711212
00228350106
00228350111
00832022500
00832022550
35356004700
35356004730
52544001160
46987041011
00054023741
00054023749
00054023755
00054023763
57664035831
57664035835
66689003201
66689003204
66689003216
66689003250
68094000162
00115128201
00228350706
00228350711
00591345301
00832023300
00832023350
35356005200
35356005230
49884083801
52544016460
54868457300
59011026305
65597030410
46987032411
49884067001
00228432311
00378266101
00406839001
00406839023
00406839062
00904656061
23490791303
23490791306
23490791309
42858079901
42858080401
43386054301
51862018801
54868559000
55887009490
59011026310
60951065870
63304045201
68084016001
68084016011
68084040601
68084040611
68382090601
00228309311
60793060801
46987032911
00054023524
00054023525
00172218260
43063027230
43063027260
43063027290
63874123803
63874123806
65597030110
68084015701
00228427011
00378265801
00406831501
00406831523
00406831562
00904655761
23490779201
23490779203
23490779206
23490779209
42858051501
42858080101
43063068960
43063068990
43386054001
49999084501
49999084530
49999084560
51862018501
52959018502
52959018530
52959018560
52959018590
54868513200
54868513204
59011026010
60951065270
63304045001
63739089910
68084040301
68382090301
69344011111
46987033011
00574711412
00115127701
00228350206
00228350211
00591344901
00832022600
00832022650
35356004800
35356004830
49884066501
49884083301
52544021160
54868457100
46987032211
00054023849
00054023863
57664035931
57664035935
66689003301
66689003304
66689003316
66689003350
00054040441
00054040444
00054040450
00054051741
00054051744
00054051750
00406800312
00406800315
00406800324
00406800330
00527142535
00527142536
00527142562
00527142563
00527190635
00527190636
00527190662
00527190663
00574012730
00574015312
00574015330
27808008201
27808008202
68094075458
68094075558
52544022060
46987037711
00228434711
00378266201
00406832001
23490791403
23490791406
23490791409
42858080501
42858090001
43386054401
59011026410
60951065970
63304045301
68382090701
00054023624
00054023625
52959018202
52959018230
52959018260
52959018290
54868497302
55289086330
55289086360
55289086390
00574711612
00115127801
00228350306
00228350311
00591345001
00832022700
35356004900
35356004930
46987032511
49884083401
52544003260
54868498100
43063027430
43063027460
43063027490
59011026105
65597030210
68084015801
00228309011
00832022750
35356023830
49884066601
60793060501
00228427111
00378265901
00406833001
00406833062
00904655861
23490777701
23490777703
23490777706
23490777709
42858063101
42858080201
43063068830
43063068860
43063068890
43386054101
49999084601
49999084630
49999084660
51862018601
52959040602
52959040630
52959040660
52959040690
55887006760
55887009260
55887009290
59011026125
60951065370
63304045101
63739072610
63874123403
63874123406
68084040401
68382090401
69344021111
46987032711
52544003960
00228311611
60793060301
00574711012
00115127901
00228350406
00228350411
00591345101
00832022800
00832022850
35356005000
35356005030
49884083501
52544005260
54868457200
46987032311
49884066701
00115128001
00228350506
00228350511
00591345201
00832022900
35356005100
35356005130
35356005160
46987032611
49884083601
52544006360
54868585000
43063027560
43063027590
43063027598
59011026205
65597030310
00228309111
00832022950
35356011830
49884066801
60793060601
00228431111
00378266001
00406838001
00406838062
00904655961
23490791203
23490791206
23490791209
42858076001
42858080301
43063068430
43063068460
43063068490
43386054201
49999084701
49999084730
49999084760
49999084790
51862018701
59011026210
60951065570
63304075801
63874123503
63874123506
68084040501
68382090501
69344031111
46987032811
00228311711
60793060401
00115128101
00228350606
00228350611
00591357601
00832023000
00832023050
35356007600
35356007630
46987041211
49884066901
49884083701
52544089660
00228309211
60793060701
60793043701
60793043720
16590089730
16590089760
16590089790
60793043001
60793043020
60793043101
60793043120
60793043301
60793043320
60793043401
60793043420
60793043501
60793043520
00591039501
21695036428
21695036460
21695036472
23490607301
23490607303
23490607308
35356017630
43063014220
43386068001
52959054502
52959054510
52959054512
52959054515
52959054520
52959054524
52959054530
52959054535
52959054540
52959054550
52959054560
52959054590
54569577201
54868478800
54868478801
55045309903
60429057001
63629320601
68387053112
68387053160
50383085516
00187420304
00187420316
42799021701
42799021702
42998020301
42998020302
62559015304
00603499321
00904659061
10702005601
10702005650
35356021160
42806000601
42858000201
42858000210
43063051230
43063051260
43063051290
43063051293
43063051298
43063051299
54868313700
57664037088
60429051701
63739017710
65162004810
68084004801
68382079401
00093573101
00115155601
00781570301
43063035402
43063035410
49884013601
59011041010
59011041020
24510011510
00228287811
00378611301
00406851501
00406851562
00603499121
00603499128
00904644561
10702000801
10702000850
13107005601
23490781902
23490781903
23490781906
23490781908
23490781909
23635058110
31722091701
31722091705
42806000701
42858000301
43063021910
43063021930
43063021960
43063021990
43063021993
43063021998
47781026401
47781026405
49999085001
49999085005
49999085030
49999085060
49999085830
49999085860
49999085890
52959012902
52959012930
52959012960
52959012990
54868472200
54868498000
55289096793
55887013301
55887013310
55887013320
55887013328
55887013350
57664018788
60429051901
63874126702
63874126703
63874126706
64720022510
65162004910
65162004950
66479058110
68084018401
68084018411
68094000561
68308011101
68382079501
00115155701
59011041510
59011041520
24510012010
00603499421
10702005701
10702005750
42806000901
42858000401
43063051130
43063051160
43063051190
43063051193
43063051198
43063051199
54868590200
57664037188
60429052001
65162005010
68084082821
68382079601
00093573201
00115155801
00781572601
16590061690
49884013701
52959014860
59011042010
59011042020
00054039344
00054052244
00527142635
00527142636
43386092060
59011022520
62559015230
66689002530
68094080101
68094080158
68308002003
68462034737
24510013010
00228287911
00378611401
00406853001
00406853062
00603499221
00603499228
00904659161
10702000901
10702000950
13107005701
23490782002
23490782003
23490782006
23490782008
23490782009
23635058210
31722091801
31722091805
42806000801
42858000501
43063022010
43063022030
43063022060
43063022077
43063022090
43063022093
43063022098
47781026501
47781026505
49999085101
49999085105
49999085130
49999085160
49999085930
49999085960
52959013002
52959013030
52959013060
52959013090
54868478300
54868539000
55289051193
55887013201
55887013202
55887013210
55887013220
55887013250
57664022488
60429052101
63874126602
63874126603
63874126606
64720022610
65162005110
65162005150
66479058210
68071045460
68084018501
68084018511
68094000659
68094000661
68308011201
68382079701
00115155901
59011043010
59011043020
24510014010
00093573301
00115156001
00591269301
00781576701
35356039930
49884013801
49999085630
52959039660
59011044010
59011044020
63304068301
00527177401
10702002301
43386095001
60687011611
60687011621
62559016701
68308014501
68462020401
00228287611
00378611201
00406055201
00406055262
00603499021
00603499028
00904644461
10702001801
10702001850
13107005501
23490778101
23490778102
23490778103
23490778106
23490778108
23490778109
23635058010
42806000501
42858000101
42858000110
43063030406
43063030415
43063030430
43063030460
43063030490
43063030493
43063030498
43063030499
43063063110
43063063120
43063063130
43063063140
43063063156
43063063160
43063063188
43063063190
43063063193
43063063198
43063063199
47781026301
47781026305
49999089930
49999089960
49999089990
52959013102
52959013130
52959013150
52959013160
52959013190
54868498300
54868498301
54868498303
55289089130
55289089160
55289089190
55289089193
55289089198
55289089199
55887005001
57664022388
60429051601
60793052501
63739036510
64720022410
65162004710
65162004750
66479058010
66479058025
68084035401
68084035411
68308010801
68308050547
68382079301
69344011311
00054039041
00054039063
00054052341
00054052363
00121483905
00121483940
60432070605
62559015116
64950035445
64950035450
64950035455
66689002401
66689002416
66689002450
66689040101
66689040150
66689040316
00115156101
59011046010
59011046020
60793052601
69344021311
00093573401
00115156201
00591270801
00781578501
35356040090
49884019701
59011048010
59011048020
63304068401
24510011010
00054028425
00093586201
00406101001
10702007101
13107010401
35356038030
60687014811
60687014821
60951079570
63481061370
64720025910
00115123201
00115123213
00228322806
00228322811
35356038860
63481043670
63481067470
63481081420
63481081460
00115131601
00115131613
00228326206
00228326211
63481081520
63481081560
00115123301
00115123313
00228322906
00228322911
63481043870
63481061770
63481061775
63481081620
63481081660
00115131701
00115131713
00228326306
00228326311
63481043970
63481057170
63481081720
63481081760
00115123401
00115123413
00228323006
00228323011
63481044070
63481069370
63481081820
63481081860
00054028325
00093586101
00406100901
10702007001
13107010301
60951079470
63481061270
64720025810
00115123101
00115123113
00228322706
00228322711
63481081220
63481081260
63481090770
63481090775
00115131501
00115131513
00228326106
00228326111
63481081320
63481081360
50458084002
50458084004
69865023002
50458086101
69865024502
50458086201
69865025002
50458086301
69865026002
50458086401
69865026501
50458082002
50458082004
69865021002
50458086001
69865024002
50458083002
50458083004
69865022002
13811068930
68025005330
68025007130
00378415293
10147090103
10370022111
21695029230
35356005530
42858090103
47335053183
47335053188
47335085983
49884082111
50458065330
59011033430
60429058330
68084096311
68084096321
68180038306
68180069706
69420300201
69467100101
13811069030
54569632800
68025005530
68025007230
00378415393
10147090203
10370022211
21695056330
42858090203
43063024130
47335053383
47335053388
47335086083
49884082211
49999089610
49999089630
50458065530
59011033530
60429058430
60760065530
68180038406
68180069806
13811069130
68025005630
68025007330
00378415493
10147090303
10370022311
21695091330
35356005630
42858090303
47335053783
47335053788
47335086183
49884082311
50458065730
59011033630
60429058530
68180038506
68180069906
00093005801
00093005805
00247123004
00247123006
00247123012
00247123015
00247123016
00247123020
00247123021
00247123025
00247123028
00247123030
00247123050
00247123060
00247123077
00247198004
00247198006
00247198010
00247198012
00247198015
00247198016
00247198020
00247198021
00247198025
00247198028
00247198030
00247198050
00247198060
00247198077
00378415101
00378415105
00378415193
00904611961
00904636561
10135051901
10135051905
10135051910
16590022920
16714011104
16714011105
16714011106
16714011110
16714011111
16714011112
16714048101
16714048102
16714048103
21695013208
21695013245
23490683200
23490683201
23490683202
23490683204
23490683205
23490683206
23490683207
23490683208
23490683209
23490784600
23490784601
23490784602
23490784603
33342020111
33342020115
33342020144
33358034201
43063005506
43353007230
43353007290
43353028330
49999002215
49999002220
49999002221
49999002225
49999002230
49999002256
49999012900
49999012901
49999012915
49999012918
49999012920
49999012924
49999012930
49999012960
49999012990
50458065960
51079099101
51079099120
51079099130
51079099156
52959041400
52959041402
52959041410
52959041415
52959041420
52959041421
52959041424
52959041428
52959041430
52959041440
52959041460
52959068800
52959068802
52959068803
52959068805
52959068810
52959068812
52959068815
52959068818
52959068820
52959068821
52959068824
52959068825
52959068828
52959068830
52959068835
52959068840
52959068850
52959068856
52959068860
52959068884
52959068890
54569408900
54569408901
54569408905
54569543600
54569543601
54569543602
54569543603
54569543604
54569543605
54569543607
54569543609
54569596700
54569596701
54569596702
54569596703
54569596704
54738021001
54868360500
54868360502
54868360503
54868360505
54868463800
55045292802
55045292803
55289065015
55289065020
55289065024
55289065030
55289071910
55289071912
55289071915
55289071920
55289071930
55289071940
55289071950
55289071960
55289071990
55289071994
55289071998
55887065810
55887065815
55887065850
55887065892
57664037708
57664037713
57664037718
58864067820
60429058801
60505017101
60505017102
60505017108
60760037709
60760037720
60760037730
60760037760
60760037798
62584055901
62584055911
63629286800
63739067110
63874532302
63874532303
63874532304
63874532305
63874532306
65162062710
65162062711
65162062750
65243030006
66267021025
66336091530
67544020753
67544027530
68084080801
68382031901
68382031905
68382031910
68387090012
69543013610
69543013611
69543013650
76439013610
76439013611
76439013650
59630082503
68453082503'''
opi_ndc_split = opi_ndc.split()
assert len(opi_ndc_split) == 2712
opi_rows = list(itertools.zip_longest(opi_ndc_split, [], fillvalue='opi'))


asthma_ndc = '''00037054568
00603119058
60258033516
24839022716
00525037616
64661081416
00037054192
38130001201
60258033601
45985064701
24839022601
00456064816
00485005916
50242004062
54868585700
55045306300
59310017540
59310020212
59310020240
54868585800
55045369508
59310017780
59310020412
59310020480
00186091612
54569592800
54868584400
00186091706
54868599000
63402071201
54868598900
63402071101
00037759012
00037759063
75989055012
00173060200
00173060202
54569626600
00173060100
00173060102
00173060002
54569626500
00173071920
49999061401
54569566300
54868536200
55045335100
00173072020
54868563700
55045335400
00173071820
35356015701
54569567100
54868599500
00173087410
00173087414
00173087610
00173087614
00085433301
00085146102
00085146107
00085433401
00085134101
00085134102
00085134103
00085134104
00085134106
00085134107
35356009914
54868554700
54868554701
54868554702
00186037020
00186037028
54868593600
00186037220
00186037228
54868593700
00173069500
00173069504
00247198360
49999098460
54569524100
54868451800
55045338801
55887067860
00173069600
00173069604
00247197360
21695019601
23490754201
49999081960
54569524200
54868451700
55045368601
58016460401
68258303101
00173069700
00173069704
00247221560
21695019701
49999098560
54569524300
54868451600
58016481301
00173071620
00173071622
00173071720
00173071722
00173071520
00173071522
00173085910
00173085914
00173088210
00173088214
00085720601
00085720607
00085461001
00085461005
00006011701
00006011728
00006011731
00006011754
00006011780
00006911731
00006911754
00006911780
00054025913
00054025922
00093742610
00093742656
00093742698
00143964909
00143964910
00143964930
00247198830
00378520193
00603465502
00603465516
00603465528
00603465532
00603465534
00781556031
00781556092
00904631061
00904652961
12280004290
13411015101
13411015103
13411015106
13411015109
13411015115
13668008130
13668008190
16729011910
16729011915
16729011917
27241001803
27241001809
27241001890
29300022010
29300022013
29300022019
31722072610
31722072630
31722072690
33342010207
33342010210
33342010215
42291062110
42291062130
42291062155
42291062190
43063038015
43063038030
49999053330
49999053390
50268057515
51079022301
51079022320
54569460500
54569634800
54868328300
54868328301
54868328302
55111072510
55111072530
55111072590
55111072594
55289096115
55289096130
58864065830
59762003001
59762003002
60505356203
60505356208
60505356209
62175021032
62175021043
62175021046
63629163901
65862057419
65862057430
65862057490
66105016402
66105016403
66105016406
66105016409
66105016410
67801030503
68001024803
68001024804
68001024805
68084062001
68084062011
68084087501
68084087511
68115092330
68258303303
68462039205
68462039230
68462039290
68645046654
68645048470
00006384130
00093748756
00378604093
27241001531
55111076303
66993041630
00006071101
00006071128
00006071131
00006071154
00006171131
00006171154
00054028813
00054028822
00093742456
00093742498
00143965109
00143965110
00143965130
00378520493
00603465302
00603465316
00603465328
00603465332
00781555431
00781555492
13668007905
13668007930
13668007990
27241001603
27241001609
31722072730
31722072790
42291062230
42291062290
43063038121
43063038130
49999095230
50268057315
54569516700
54868463000
55111059330
55111059390
55289098921
55289098930
59746035830
59746035890
59762004501
59762004502
60505357303
60505357308
60505357309
62175020432
62175020443
62175020446
65862056705
65862056730
65862056790
68084063811
68084063821
00006027501
00006027528
00006027531
00006027554
00006027582
00006927531
00006927554
00006927582
00054028913
00054028922
00093742556
00093742598
00143965009
00143965010
00143965030
00378520593
00603465402
00603465416
00603465428
00603465432
00781555531
00781555592
13411016001
13411016003
13411016006
13411016009
13411016015
13668008005
13668008030
13668008090
27241001703
27241001709
31722072830
31722072890
42291062330
42291062390
49999088430
49999088490
50268057415
54569473600
54868484700
55111059430
55111059490
55289099021
55289099030
55887012090
58864069430
59746035930
59746035990
59762004601
59762004602
60505357403
60505357408
60505357409
62175020532
62175020543
62175020546
65862056805
65862056830
65862056890
68084061901
68084061911
68084086401
68258303203
00247189700
00247189730
00247189760
00247189777
00247189790
00310040160
00310041160
49884001002
49884030302
49884054902
49884058902
55111062560
66105050106
00247189800
00247189814
00247189830
00247189860
00247189877
00247189890
00310040260
00310041260
49884001102
49884030402
49884055402
49884059002
54569460401
54569632100
55111062660
66105050206
68084005921
10122090112
10122090212
00172640605
00172640649
00172640659
54569454900
54569477200
60432015706
60432015721
00143102001
00143102010
00143102501
00143102510
49999055000
00037052192
00037073192
00247082406
00247082410
00247082430
00247082460
00247082490
00490008000
00490008030
00490008060
00490008090
00904588761
42291081390
49999092130
50111048301
50111048302
54868146101
54868146102
55045376808
63629355101
63874044301
63874044315
63874044320
63874044330
65162033510
50474010001
52244010010
00247065602
00247065604
00247065610
00247065614
00247065620
00247065628
00247065630
00247065660
00904588861
35356012660
42291081490
50111048201
50111048202
50111048203
54868002800
54868002801
54868002802
54868002803
54868002805
54868002806
55887027730
61392001645
61392001654
61392001656
61392001691
63629279201
63629279202
63874044701
63874044715
63874044720
63874044730
63874044760
65162032411
50474020001
50474020050
52244020010
00904588961
23155006201
23490735501
42291081590
50111045901
50111045902
50111045903
54569006501
54569006502
54569006505
54868002900
54868002902
54868002903
54868002905
54868002906
54868002907
55887084760
55887084790
61392001754
61392001756
61392001791
62332002531
63874067501
63874067515
63874067520
50474030001
50474030050
52244030010
54569166600
54868271000
54868271001
50474040001
52244040010
29033000101
42858070101
68462038001
23155006301
50111051801
62332002631
29033000201
42858070201
68462035601
00121479415
17856064430
17856064431
49708064490
10135060408
27808003301
51862013116
54838055680
59310058020
00085113201
00173068220
00173068221
00173068224
00173068254
00173068281
21695085185
23490797201
35356016601
49999090767
49999090885
52959056901
52959097801
54569462100
54569577700
54569616600
54569616700
54868605000
54868605001
54868605100
55045349401
55887004318
59310057920
59310057922
68258303701
00247222701
49999092215
54569585300
63402051001
29336081521
54868282101
99207028040
'''

asthma_ndc_split = asthma_ndc.split()
assert len(asthma_ndc_split) == 538
asthma_rows = list(itertools.zip_longest(asthma_ndc_split, [], fillvalue='asth'))


# diabetes

# diabetes does not have a list of NDC instead ahfs classes are used
# the ahfs class must start with 6820
# issue is only some data sources have ahfs_class data optz and optd
# selects all ndc that have the ahfs class 6820 then use those as our ndc list
# to match to all data sources
# ahfs is liscense and this was best way to get ndc as of now

with con.cursor() as cursor:
    sql_command = """select distinct ndc from data_warehouse.pharmacy_claims where ahfs_class like '6820%' """
    cursor.execute(sql_command)
    diabetes_ndc= cursor.fetchall()

diabetes_rows = list(itertools.zip_longest([i[0] for i in diabetes_ndc], [], fillvalue='db'))


# insert
with con.cursor() as cursor:
    cursor.execute('''
    DROP TABLE IF EXISTS conditions.condition_ndc;
    CREATE TABLE conditions.condition_ndc (
        ndc bpchar(11) NULL,
        condition_cd varchar NULL,
        logic_version text NULL
    )
    DISTRIBUTED RANDOMLY;
    ''')
    sql_command = 'insert into conditions.condition_ndc(ndc, condition_cd) values (?, ?)'
    cursor.fast_executemany = True
    cursor.executemany(sql_command, opi_rows)
    cursor.executemany(sql_command, asthma_rows)
    
    cursor.execute("update conditions.condition_ndc set logic_version = 'v40'; ")


con.close()

